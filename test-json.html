<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>测试JSON文件</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a2e;
            color: #e6e6e6;
        }
        textarea {
            width: 100%;
            height: 300px;
            background: #0a0a15;
            color: #e6e6e6;
            border: 1px solid #2d2d42;
            padding: 10px;
            font-family: monospace;
        }
        button {
            background: #8b0000;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            cursor: pointer;
            border-radius: 4px;
        }
        .error {
            color: #ff6b6b;
        }
        .success {
            color: #27ae60;
        }
    </style>
</head>
<body>
    <h1>JSON文件测试工具</h1>
    
    <div>
        <label for="jsonFile">选择JSON文件：</label>
        <input type="file" id="jsonFile" accept=".json">
    </div>
    
    <div>
        <h3>文件内容：</h3>
        <textarea id="jsonContent" readonly></textarea>
    </div>
    
    <div id="result"></div>
    
    <script>
        document.getElementById('jsonFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                document.getElementById('jsonContent').value = content;
                
                try {
                    const json = JSON.parse(content);
                    const resultDiv = document.getElementById('result');
                    
                    // 检查是否包含必需字段
                    const hasLogs = Array.isArray(json.logs);
                    const logCount = hasLogs ? json.logs.length : 0;
                    
                    let html = `<h3 class="success">✓ JSON格式正确</h3>`;
                    html += `<p>文件大小：${content.length} 字符</p>`;
                    html += `<p>包含 logs 数组：${hasLogs ? '是' : '否'}</p>`;
                    html += `<p>消息数量：${logCount}</p>`;
                    
                    if (hasLogs && logCount > 0) {
                        const firstLog = json.logs[0];
                        html += `<h4>第一条消息示例：</h4>`;
                        html += `<pre>${JSON.stringify(firstLog, null, 2)}</pre>`;
                    }
                    
                    resultDiv.innerHTML = html;
                } catch (error) {
                    document.getElementById('result').innerHTML = 
                        `<h3 class="error">✗ JSON解析错误</h3>
                         <p>错误信息：${error.message}</p>
                         <p>问题可能出现在位置：${error.message.match(/position (\d+)/)?.[1] || '未知'}</p>`;
                }
            };
            
            reader.readAsText(file);
        });
    </script>
</body>
</html>
